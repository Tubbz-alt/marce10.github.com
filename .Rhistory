dln <- x[dl]
dln <- gsub("date:","", dln)
y <- sapply(strsplit(as.character(dln), "-",fixed=T), "[[", 1)
y <- gsub(" ","", y)
m <- sapply(strsplit(as.character(dln), "-",fixed=T), "[[", 2)
m <- gsub(" ","", m)
d <- sapply(strsplit(as.character(dln), "-",fixed=T), "[[", 3)
d <- gsub(" ","", d)
dln <- paste(d, m, y, sep = "-")
dln <- gsub('"',"", dln)
dln <- gsub(' ',"", dln)
x[dl] <- paste("date:", dln)
#remove output:
x <- x[-grep("output:", x)]
#remove md_document:
x <- x[-grep("md_document:", x)]
#remove variant: markdown_github
x <- x[-grep("variant: markdown_github", x)]
#remove output:
x <- x[-grep("author:", x)]
#put it together as a file
cat(x, file = corresponding.md.file, sep="\n")
#change name to include date
nn <- paste(y, m , d, basename(corresponding.md.file), sep = "-")
nn <- gsub('"',"", nn)
#replace spaces with _
nn <- gsub(" ","_", nn)
file.rename(from = corresponding.md.file, to = file.path(posts.path, nn))
unlink(list.files(path = "~/Dropbox/Websites/Blog/maRce10.github.com/_Rmd/", pattern = "\\.wav$"))
setwd(wdX)
}
#or
setwd("~/Dropbox/Websites/Blog/maRce10.github.com")
#or
setwd("~/Dropbox/Websites/Blog/marce10.github.com/")
#or
setwd("~/Dropbox/Websites/Blog/marce10.github.com")
system("git add .")
system('git commit -m "update resources"')
#function modified from http://brooksandrew.github.io/simpleblog/articles/blogging-with-r-markdown-and-jekyll-using-knitr/
KnitPost <- function(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file = NULL, categories = NULL , tags = NULL, tags.eq.cats = TRUE, rm.output.text = FALSE) {
if(!'package:knitr' %in% search()) library('knitr')
wdX <- getwd()
if(is.null(rmd.file)) stop("need to provide rmd.file biatch!")
## Blog-specific directories.  This will depend on how you organize your blog.
site.path <- site.path # directory of jekyll blog (including trailing slash)
rmd.path <- paste0(site.path, "_Rmd") # directory where your Rmd-files reside (relative to base)
fig.dir <- "assets/Rfig/" # directory to save figures
posts.path <- paste0(site.path, "_posts/") # directory for converted markdown files
cache.path <- paste0(site.path, "_cache") # necessary for plots
render_jekyll()
opts_knit$set(base.url = '/', base.dir = site.path)
opts_chunk$set(fig.path=fig.dir, fig.width=8.5, fig.height=5.25, dev='png', cache=F,
warning=F, message=F, cache.path=cache.path, tidy=F, dpi = 70)
setwd(rmd.path) # setwd to base
corresponding.md.file <- paste0(posts.path, "/", basename(gsub(pattern = "\\.Rmd$", replacement = ".md", x = rmd.file)))
#knitr!!
out.file <- knit(as.character(rmd.file),
output = as.character(corresponding.md.file),
envir = parent.frame(),
quiet = T)
message(paste0("KnitPost(): ", rmd.file))
#fix heading to jekyll format
#add layout post
x <- readLines(corresponding.md.file)
x <- c(x[1], "layout: post", x[2:length(x)])
#fix date format
dl <- grep("date:", x)
dln <- x[dl]
dln <- gsub("date:","", dln)
y <- sapply(strsplit(as.character(dln), "-",fixed=T), "[[", 1)
y <- gsub(" ","", y)
m <- sapply(strsplit(as.character(dln), "-",fixed=T), "[[", 2)
m <- gsub(" ","", m)
d <- sapply(strsplit(as.character(dln), "-",fixed=T), "[[", 3)
d <- gsub(" ","", d)
dln <- paste(d, m, y, sep = "-")
dln <- gsub('"',"", dln)
dln <- gsub(' ',"", dln)
x[dl] <- paste("date:", dln)
#remove output:
x <- x[-grep("output:", x)]
#remove md_document:
x <- x[-grep("md_document:", x)]
#remove variant: markdown_github
x <- x[-grep("variant: markdown_github", x)]
#remove output:
x <- x[-grep("author:", x)]
#put it together as a file
cat(x, file = corresponding.md.file, sep="\n")
#change name to include date
nn <- paste(y, m , d, basename(corresponding.md.file), sep = "-")
nn <- gsub('"',"", nn)
#replace spaces with _
nn <- gsub(" ","_", nn)
file.rename(from = corresponding.md.file, to = file.path(posts.path, nn))
unlink(list.files(path = "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/", pattern = "\\.wav$"))
setwd(wdX)
}
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/barulho.Rmd", rm.output.text = F)
#load package
library(baRulho)
# From github
devtools::install_github("maRce10/baRulho")
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/barulho.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/barulho.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/barulho.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/barulho.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/barulho.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/barulho.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/barulho.Rmd", rm.output.text = F)
setwd("~/Dropbox/Websites/Blog/marce10.github.com")
system("git add .")
system('git commit -m "baRulho"')
system("git push origin HEAD:master")
system("git add .")
system("git add .")
system('git commit -m "baRulho"')
temdir()
tempdir()
#function modified from http://brooksandrew.github.io/simpleblog/articles/blogging-with-r-markdown-and-jekyll-using-knitr/
KnitPost <- function(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file = NULL, categories = NULL , tags = NULL, tags.eq.cats = TRUE, rm.output.text = FALSE) {
if(!'package:knitr' %in% search()) library('knitr')
wdX <- getwd()
if(is.null(rmd.file)) stop("need to provide rmd.file biatch!")
## Blog-specific directories.  This will depend on how you organize your blog.
site.path <- site.path # directory of jekyll blog (including trailing slash)
rmd.path <- paste0(site.path, "_Rmd") # directory where your Rmd-files reside (relative to base)
fig.dir <- "assets/Rfig/" # directory to save figures
posts.path <- paste0(site.path, "_posts/") # directory for converted markdown files
cache.path <- paste0(site.path, "_cache") # necessary for plots
render_jekyll()
opts_knit$set(base.url = '/', base.dir = site.path)
opts_chunk$set(fig.path=fig.dir, fig.width=8.5, fig.height=5.25, dev='png', cache=F,
warning=F, message=F, cache.path=cache.path, tidy=F, dpi = 70)
setwd(rmd.path) # setwd to base
corresponding.md.file <- paste0(posts.path, "/", basename(gsub(pattern = "\\.Rmd$", replacement = ".md", x = rmd.file)))
#knitr!!
out.file <- knit(as.character(rmd.file),
output = as.character(corresponding.md.file),
envir = parent.frame(),
quiet = T)
message(paste0("KnitPost(): ", rmd.file))
#fix heading to jekyll format
#add layout post
x <- readLines(corresponding.md.file)
x <- c(x[1], "layout: post", x[2:length(x)])
#fix date format
dl <- grep("date:", x)
dln <- x[dl]
dln <- gsub("date:","", dln)
y <- sapply(strsplit(as.character(dln), "-",fixed=T), "[[", 1)
y <- gsub(" ","", y)
m <- sapply(strsplit(as.character(dln), "-",fixed=T), "[[", 2)
m <- gsub(" ","", m)
d <- sapply(strsplit(as.character(dln), "-",fixed=T), "[[", 3)
d <- gsub(" ","", d)
dln <- paste(d, m, y, sep = "-")
dln <- gsub('"',"", dln)
dln <- gsub(' ',"", dln)
x[dl] <- paste("date:", dln)
#remove output:
x <- x[-grep("output:", x)]
#remove md_document:
x <- x[-grep("md_document:", x)]
#remove variant: markdown_github
x <- x[-grep("variant: markdown_github", x)]
#remove output:
x <- x[-grep("author:", x)]
#put it together as a file
cat(x, file = corresponding.md.file, sep="\n")
#change name to include date
nn <- paste(y, m , d, basename(corresponding.md.file), sep = "-")
nn <- gsub('"',"", nn)
#replace spaces with _
nn <- gsub(" ","_", nn)
file.rename(from = corresponding.md.file, to = file.path(posts.path, nn))
unlink(list.files(path = "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/", pattern = "\\.wav$"))
setwd(wdX)
}
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/barulho.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/barulho.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/barulho.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/barulho.Rmd", rm.output.text = F)
#or
setwd("~/Dropbox/Websites/Blog/marce10.github.com")
system("git add .")
system('git commit -m "baRulho updated"')
#function modified from http://brooksandrew.github.io/simpleblog/articles/blogging-with-r-markdown-and-jekyll-using-knitr/
KnitPost <- function(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file = NULL, categories = NULL , tags = NULL, tags.eq.cats = TRUE, rm.output.text = FALSE) {
if(!'package:knitr' %in% search()) library('knitr')
wdX <- getwd()
if(is.null(rmd.file)) stop("need to provide rmd.file biatch!")
on.exit(setwd(wdX))
setwd(site.path)
## Blog-specific directories.  This will depend on how you organize your blog.
# site.path <- site.path # directory of jekyll blog (including trailing slash)
rmd.path <- paste0(site.path, "_Rmd") # directory where your Rmd-files reside (relative to base)
fig.dir <- "assets/Rfig/" # directory to save figures
posts.path <- paste0(site.path, "_posts/") # directory for converted markdown files
cache.path <- paste0(site.path, "_cache") # necessary for plots
render_jekyll()
opts_knit$set(base.url = '/', base.dir = site.path)
opts_chunk$set(fig.path=fig.dir, fig.width=8.5, fig.height=5.25, dev='png', cache=F,
warning=F, message=F, cache.path=cache.path, tidy=F, dpi = 70)
setwd(site.path) # setwd to base
corresponding.md.file <- paste0(posts.path, "/", basename(gsub(pattern = "\\.Rmd$", replacement = ".md", x = rmd.file)))
#knitr!!
out.file <- knit(as.character(rmd.file),
output = as.character(corresponding.md.file),
envir = parent.frame(),
quiet = T)
message(paste0("KnitPost(): ", rmd.file))
#fix heading to jekyll format
#add layout post
x <- readLines(corresponding.md.file)
x <- c(x[1], "layout: post", x[2:length(x)])
#fix date format
dl <- grep("date:", x)
dln <- x[dl]
dln <- gsub("date:","", dln)
y <- sapply(strsplit(as.character(dln), "-",fixed=T), "[[", 1)
y <- gsub(" ","", y)
m <- sapply(strsplit(as.character(dln), "-",fixed=T), "[[", 2)
m <- gsub(" ","", m)
d <- sapply(strsplit(as.character(dln), "-",fixed=T), "[[", 3)
d <- gsub(" ","", d)
dln <- paste(d, m, y, sep = "-")
dln <- gsub('"',"", dln)
dln <- gsub(' ',"", dln)
x[dl] <- paste("date:", dln)
#remove output:
x <- x[-grep("output:", x)]
#remove md_document:
x <- x[-grep("md_document:", x)]
#remove variant: markdown_github
x <- x[-grep("variant: markdown_github", x)]
#remove output:
x <- x[-grep("author:", x)]
#put it together as a file
cat(x, file = corresponding.md.file, sep="\n")
#change name to include date
nn <- paste(y, m , d, basename(corresponding.md.file), sep = "-")
nn <- gsub('"',"", nn)
#replace spaces with _
nn <- gsub(" ","_", nn)
file.rename(from = corresponding.md.file, to = file.path(posts.path, nn))
unlink(list.files(path = "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/", pattern = "\\.wav$"))
setwd(wdX)
}
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/barulho.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/barulho.Rmd", rm.output.text = F)
#or
setwd("~/Dropbox/Websites/Blog/marce10.github.com")
system("git add .")
system('git commit -m "baRulho updated 3"')
af.w<-c(0,24.7,20.4,46.8,17.3,30,60.6,62.1,57.9,31.3)
af.g<-c(24.2,0,21.0,48.7,19.0,30.9,60.6,63.6,60.4,31.8)
af.e<-c(20.8,21.8,0,41.7,14.9,23.6,58.6,63.2,57.3,27.6)
af.h<-c(29.5,31.6,21.5,0,28.2,26.3,49.9,56.8,49.1,36.1)
af.s<-c(37.8,39.4,35.5,58.4,0,33.1,68.5,71.9,68.0, 47.7)
af.k<-c(61.8,61.8,56.8,69.3,51.3,0,75.6,78.9,74.8,64.0)
eu<-c(25.8,25.4,19.4,28.4,20.4,20,0,39.1,16.8,29.1)
asi<-c(18.5,21.3,18.5,29.0,20.0,18.6,28.8,0,24.0,22.0)
mi.ha<-c(27.4,31.6,23.9,32.7,25.8,23.1,23.9,40.5,0,30.9)
mi.aa<-c(20.6,19.7,15.1,44.1,18.7,23.6,56.3,58.6,54.2,0)
data<-cbind(af.w,af.g,af.e,af.h,af.s,af.k,eu,asi,mi.ha,mi.aa)
rownames(data)<-c("af.w","af.e","af.g","af.h","af.s","af.k","eu","asi","mi.ha","mi.aa")
data<-(100-data)
heatmaply(data.2, margins = c(40, 130),
seriate = "OLO")
install.packages("heatmaply")
library(heatmaply)
heatmaply(data.2, margins = c(40, 130),
seriate = "OLO")
library(heatmaply)
heatmaply(data, margins = c(40, 130),
seriate = "OLO")
colnames(data)
colnames(data) <- paste0("ak", 1:ncol(data))
data
rownames(data) <- paste0("fk", 1:nrow(data))
heatmaply(data, margins = c(40, 130),
seriate = "OLO")
mi.aa <- sample(mi.aa)
mi.ha <- sample(mi.ha)
af.e <- sample(af.e)
af.s <- sample(af.s)
data<-cbind(af.w,af.g,af.e,af.h,af.s,af.k,eu,asi,mi.ha,mi.aa)
rownames(data)<-c("af.w","af.e","af.g","af.h","af.s","af.k","eu","asi","mi.ha","mi.aa")
data<-(100-data)
library(heatmaply)
colnames(data) <- paste0("ak", 1:ncol(data))
rownames(data) <- paste0("fk", 1:nrow(data))
heatmaply(data, margins = c(40, 130),
seriate = "OLO")
rm(list = ls())
#
# unload all non-based packages
out <- sapply(paste('package:', names(sessionInfo()$otherPkgs), sep = ""), function(x) try(detach(x, unload = FALSE, character.only = TRUE), silent = T))
x <- c("RColorBrewer", "devtools", "seewave", "warbleR", "monitoR", "pkgdown", "ape", "jpeg", "wavethresh")
aa <- lapply(x, function(y){
if(!y %in% installed.packages()[,"Package"])  {if(y != "warbleR") install.packages(y) else devtools::install_github("maRce10/warbleR")
}
try(require(y, character.only = T), silent = T)
})
xcmaps()
X <- querxc("Phaethornis anthophilus", download = FALSE)
#create leaflet map
xcmaps(X, leaflet.map = TRUE)
#function modified from http://brooksandrew.github.io/simpleblog/articles/blogging-with-r-markdown-and-jekyll-using-knitr/
KnitPost <- function(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file = NULL, categories = NULL , tags = NULL, tags.eq.cats = TRUE, rm.output.text = FALSE) {
if(!'package:knitr' %in% search()) library('knitr')
wdX <- getwd()
if(is.null(rmd.file)) stop("need to provide rmd.file biatch!")
on.exit(setwd(wdX))
setwd(site.path)
## Blog-specific directories.  This will depend on how you organize your blog.
# site.path <- site.path # directory of jekyll blog (including trailing slash)
rmd.path <- paste0(site.path, "_Rmd") # directory where your Rmd-files reside (relative to base)
fig.dir <- "assets/Rfig/" # directory to save figures
posts.path <- paste0(site.path, "_posts/") # directory for converted markdown files
cache.path <- paste0(site.path, "_cache") # necessary for plots
render_jekyll()
opts_knit$set(base.url = '/', base.dir = site.path)
opts_chunk$set(fig.path=fig.dir, fig.width=8.5, fig.height=5.25, dev='png', cache=F,
warning=F, message=F, cache.path=cache.path, tidy=F, dpi = 70)
setwd(site.path) # setwd to base
corresponding.md.file <- paste0(posts.path, "/", basename(gsub(pattern = "\\.Rmd$", replacement = ".md", x = rmd.file)))
#knitr!!
out.file <- knit(as.character(rmd.file),
output = as.character(corresponding.md.file),
envir = parent.frame(),
quiet = T)
message(paste0("KnitPost(): ", rmd.file))
#fix heading to jekyll format
#add layout post
x <- readLines(corresponding.md.file)
x <- c(x[1], "layout: post", x[2:length(x)])
#fix date format
dl <- grep("date:", x)
dln <- x[dl]
dln <- gsub("date:","", dln)
y <- sapply(strsplit(as.character(dln), "-",fixed=T), "[[", 1)
y <- gsub(" ","", y)
m <- sapply(strsplit(as.character(dln), "-",fixed=T), "[[", 2)
m <- gsub(" ","", m)
d <- sapply(strsplit(as.character(dln), "-",fixed=T), "[[", 3)
d <- gsub(" ","", d)
dln <- paste(d, m, y, sep = "-")
dln <- gsub('"',"", dln)
dln <- gsub(' ',"", dln)
x[dl] <- paste("date:", dln)
#remove output:
x <- x[-grep("output:", x)]
#remove md_document:
x <- x[-grep("md_document:", x)]
#remove variant: markdown_github
x <- x[-grep("variant: markdown_github", x)]
#remove output:
x <- x[-grep("author:", x)]
#put it together as a file
cat(x, file = corresponding.md.file, sep="\n")
#change name to include date
nn <- paste(y, m , d, basename(corresponding.md.file), sep = "-")
nn <- gsub('"',"", nn)
#replace spaces with _
nn <- gsub(" ","_", nn)
file.rename(from = corresponding.md.file, to = file.path(posts.path, nn))
unlink(list.files(path = "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/", pattern = "\\.wav$"))
setwd(wdX)
}
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
webshot::install_phantomjs()
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
X
#create leaflet map
xcmaps(X, leaflet.map = TRUE)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
normalizePath("..")
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
#function modified from http://brooksandrew.github.io/simpleblog/articles/blogging-with-r-markdown-and-jekyll-using-knitr/
KnitPost <- function(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file = NULL, categories = NULL , tags = NULL, tags.eq.cats = TRUE, rm.output.text = FALSE) {
if(!'package:knitr' %in% search()) library('knitr')
wdX <- getwd()
if(is.null(rmd.file)) stop("need to provide rmd.file biatch!")
on.exit(setwd(wdX))
setwd(site.path)
## Blog-specific directories.  This will depend on how you organize your blog.
# site.path <- site.path # directory of jekyll blog (including trailing slash)
rmd.path <- paste0(site.path, "_Rmd") # directory where your Rmd-files reside (relative to base)
fig.dir <- "assets/Rfig/" # directory to save figures
posts.path <- paste0(site.path, "_posts/") # directory for converted markdown files
cache.path <- paste0(site.path, "_cache") # necessary for plots
render_jekyll()
opts_knit$set(base.url = '/', base.dir = site.path)
opts_chunk$set(fig.path=fig.dir, fig.width=8.5, fig.height=5.25, dev='png', cache=F,
warning=F, message=F, cache.path=cache.path, tidy=F, dpi = 70)
setwd(site.path) # setwd to base
corresponding.md.file <- paste0(posts.path, "/", basename(gsub(pattern = "\\.Rmd$", replacement = ".md", x = rmd.file)))
#knitr!!
out.file <- knit(as.character(rmd.file),
output = as.character(corresponding.md.file),
envir = parent.frame(),
quiet = T)
message(paste0("KnitPost(): ", rmd.file))
#fix heading to jekyll format
#add layout post
x <- readLines(corresponding.md.file)
x <- c(x[1], "layout: post", x[2:length(x)])
#fix date format
dl <- grep("date:", x)
dln <- x[dl]
dln <- gsub("date:","", dln)
y <- sapply(strsplit(as.character(dln), "-",fixed=T), "[[", 1)
y <- gsub(" ","", y)
m <- sapply(strsplit(as.character(dln), "-",fixed=T), "[[", 2)
m <- gsub(" ","", m)
d <- sapply(strsplit(as.character(dln), "-",fixed=T), "[[", 3)
d <- gsub(" ","", d)
dln <- paste(d, m, y, sep = "-")
dln <- gsub('"',"", dln)
dln <- gsub(' ',"", dln)
x[dl] <- paste("date:", dln)
#remove output:
x <- x[-grep("output:", x)]
#remove md_document:
x <- x[-grep("md_document:", x)]
#remove variant: markdown_github
x <- x[-grep("variant: markdown_github", x)]
#remove output:
x <- x[-grep("author:", x)]
#put it together as a file
cat(x, file = corresponding.md.file, sep="\n")
#change name to include date
nn <- paste(y, m , d, basename(corresponding.md.file), sep = "-")
nn <- gsub('"',"", nn)
#replace spaces with _
nn <- gsub(" ","_", nn)
file.rename(from = corresponding.md.file, to = file.path(posts.path, nn))
unlink(list.files(path = "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/", pattern = "\\.wav$"))
setwd(wdX)
}
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
#create leaflet map
a <- xcmaps(X, leaflet.map = TRUE)
a
apropos("view")
setView(a, lng = c(-82, -84), lat = c(8, 9))
setView(a, lng = c(-82, -84), lat = c(8, 9), zoom = 2)
setView(a, lng = -83.175156, lat = 8.655394, zoom = 2)
setView(a, lng = -83.175156, lat = 8.655394, zoom = 1)
setView(a, lng = -83.175156, lat = 8.655394, zoom = 4)
setView(a, lng = -83.175156, lat = 8.655394, zoom = 5)
setView(a, lng = -82.175156, lat = 8, zoom = 5)
X <- querxc("Phaethornis longirostris", download = FALSE, pb = FALSE)
X <- querxc("Phaethornis longirostris", download = FALSE, pb = FALSE)
a <- xcmaps(X, leaflet.map = TRUE)
setView(a, lng = -82.175156, lat = 8, zoom = 5)
setView(a, lng = -82.175156, lat = 8, zoom = 7)
setView(a, lng = -82.175156, lat = 8, zoom = 9)
setView(a, lng = -82.175156, lat = 8.4, zoom = 9)
setView(a, lng = -82.175156, lat = 9, zoom = 9)
setView(a, lng = -82.175156, lat = 10, zoom = 9)
setView(a, lng = -83, lat = 10, zoom = 9)
setView(a, lng = -84, lat = 10, zoom = 9)
setView(a, lng = -88, lat = 10, zoom = 9)
#create leaflet map
a <- xcmaps(X, leaflet.map = TRUE)
setView(a, lng = -88, lat = 10, zoom = 9)
setView(a, lng = -87.5, lat = 10, zoom = 9)
setView(a, lng = -87, lat = 10, zoom = 9)
setView(a, lng = -86, lat = 10, zoom = 9)
setView(a, lng = -84, lat = 10, zoom = 9)
setView(a, lng = -84, lat = 11, zoom = 9)
setView(a, lng = -84, lat = 10.5, zoom = 9)
setView(a, lng = -84, lat = 10.5, zoom = 11)
setView(a, lng = -84, lat = 10.5, zoom = 12)
setView(a, lng = -84, lat = 10.7, zoom = 12)
setView(a, lng = -84, lat = 10.2, zoom = 12)
setView(a, lng = -84, lat = 10.7, zoom = 12)
setView(a, lng = -84, lat = 10.5, zoom = 12)
setView(a, lng = -84, lat = 10.45, zoom = 12)
setView(a, lng = -84, lat = 10.44, zoom = 12)
setView(a, lng = -84, lat = 10.44, zoom = 13)
X <- querxc("Phaethornis", download = FALSE, pb = FALSE)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/marce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/marce10.github.com/_Rmd/leaflet xcmaps.Rmd", rm.output.text = F)
#or
setwd("~/Dropbox/Websites/Blog/marce10.github.com")
system("git add .")
system('git commit -m "leaflet maps"')
#or
setwd("~/Dropbox/Websites/Blog/marce10.github.com")
system("git add .")
system('git commit -m "leaflet maps 2"')
