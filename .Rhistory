#   rmls <- list()
#
#   for(i in 2:length(x)) if(x[i] == "<br>" & x[i] == x[i - 1])  rmls[[length(rmls) + 1]] <- i
#
#   x <- x[-unlist(rmls)]
#
#
# #remove the ones within chuncks
#     b1 <-  grep("{% highlight r %}", x, fixed = T)
#     b2 <-  grep("{% endhighlight %}", x, fixed = T)
#
#   rmchnk <- list()
#     for(i in 1:length(b1))
#       rmchnk[[length(rmchnk) + 1]] <- c(b1[i]:b2[b2 > b1[i]][1])
#
#   xchnk <- x[unlist(rmchnk)]
#   xchnk[xchnk == "<br>"] <- ""
#   x[unlist(rmchnk)] <-  xchnk
#remove highlight code in chunck header
# x <- gsub("{% highlight r %}|{% highlight text %}", "``` r", x, fixed = T)
# x <- gsub("{% endhighlight %}", "```", x, fixed = T)
#
# x[x == "{% highlight r %}"] <- "``` r"
# x[x == "{% highlight text %}"] <- "``` r"
# x[x == "{% endhighlight %}"] <- "```"
#
#put it together as a file
cat(x, file = corresponding.md.file, sep="\n")
#change name to include date
nn <- paste(y, m , d, basename(corresponding.md.file), sep = "-")
nn <- gsub('"',"", nn)
#replace spaces with _
nn <- gsub(" ","_", nn)
file.rename(from = corresponding.md.file, to = file.path(posts.path, nn))
unlink(list.files(path = "~/Dropbox/Websites/Blog/maRce10.github.com/_Rmd/", pattern = "\\.wav$"))
}
KnitPost(site.path = "~/Dropbox/Websites/Blog/maRce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/maRce10.github.com/_Rmd/Detecting_signals_with_monitoR.Rmd", categories = "cross-correlation, automatic detection", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/maRce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/maRce10.github.com/_Rmd/Download a single recording for each species in a site from Xeno-Canto.Rmd", categories = "querxc", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/maRce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/maRce10.github.com/_Rmd/Detecting_signals_with_monitoR.Rmd", categories = "cross-correlation, automatic detection", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/maRce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/maRce10.github.com/_Rmd/Detecting_signals_with_monitoR.Rmd", categories = "cross-correlation, automatic detection", rm.output.text = F)
KnitPost(site.path = "~/Dropbox/Websites/Blog/maRce10.github.com/", rmd.file =  "~/Dropbox/Websites/Blog/maRce10.github.com/_Rmd/Detecting_signals_with_monitoR.Rmd", categories = "cross-correlation, automatic detection", rm.output.text = F)
wav1 <- readWave("~/Dropbox/Thr.bro.2009.7.22.0005.wav", from = 0, to = 10, units = "seconds")
library(warbleR)
spectro(wav1)
wav1 <- readWave("~/Dropbox/Thr.bro.2009.7.22.0005.wav", from = 0, to = 10, units = "seconds")
spectro(wav1)
wav1 <- readWave("~/Dropbox/Thr.bro.2009.7.22.0005.wav", from = 40, to = 53, units = "seconds")
spectro(wav1)
spectro(wav1, flim = c(2, 8))
wav1 <- readWave("~/Dropbox/Thr.bro.2009.7.22.0005.wav", from = 120, to = 140, units = "seconds")
spectro(wav1, flim = c(2, 8))
wav1 <- readWave("~/Dropbox/Thr.bro.2009.7.22.0005.wav", from = 134, to = 160, units = "seconds")
spectro(wav1, flim = c(2, 8))
wav1 <- readWave("~/Dropbox/Thr.bro.2009.7.22.0005.wav", from = 134, to = 150, units = "seconds")
spectro(wav1, flim = c(2, 8))
spectro(wav1, flim = c(2, 8), wl = 100)
wav1 <- readWave("~/Dropbox/Thr.bro.2009.7.22.0005.wav", from = 134, to = 145, units = "seconds")
spectro(wav1, flim = c(2, 8), wl = 100)
wav1 <- readWave("~/Dropbox/Thr.bro.2009.7.22.0005.wav", from = 134, to = 140, units = "seconds")
spectro(wav1, flim = c(2, 8), wl = 100)
wav1 <- readWave("~/Dropbox/Thr.bro.2009.7.22.0005.wav", from = 134, to = 145, units = "seconds")
spectro(wav1, flim = c(2, 8), wl = 100)
wav1 <- readWave("~/Dropbox/Thr.bro.2009.7.22.0005.wav", from = 134, to = 147, units = "seconds")
spectro(wav1, flim = c(2, 8), wl = 100)
wav1 <- readWave("~/Dropbox/Thr.bro.2009.7.22.0005.wav", from = 134, to = 146, units = "seconds")
spectro(wav1, flim = c(2, 8), wl = 100)
tlimsize <- 0.7
wav <-pastew(wave2 = wav1, wave1 = wav1, f = wav@samp.rate,
output = "Wave")
spectro(wav)
fps <- 100
marg <- tlimsize / 2
setwd(tempdir())
tiff("fee%04d.tiff",res = 120, width = 2300, height = 600)
out <- pbapply::pblapply(seq(0, (length(wav@left)/wav@samp.rate) - tlimsize, by = 1/fps), function(x)
{  tlim <- c(x, x + tlimsize)
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = c(2, 13), tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5,
osc = F, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
par(family = "helvetica")
text(x = tlim[1] + (tlimsize/2), y = 7, labels =  "Marcelo Araya-Salas", cex = 7, adj = 0.5, col = "black", font = 2)
# abline(v = tlim[1]+marg, lty = 2, col = "skyblue", lwd = 2)
# x <- x + 1/fps
# stop when the end is reached
# if(x >= (length(wav@left)/wav@samp.rate) - tlimsize) break
}
)
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
tiff("fee%04d.tiff",res = 120, width = 2300, height = 600)
x = 0
tlim <- c(x, x + tlimsize)
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = c(2, 13), tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(3, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
dev.off()
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = c(2, 13), tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(3, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = c(2, 13), tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(3, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
wav1 <- readWave("~/Dropbox/PAE3 new 062715 DT4.wav", from = 134, to = 146, units = "seconds")
wav1 <- readWave("~/Dropbox/PAE3 new 062715 DT4.wav", from = 134, to = 146, units = "seconds")
wav1 <- readWave("~/Dropbox/PAE3 new 062715 DT4.wav", units = "seconds")
spectro(wav1, flim = c(2, 8), wl = 100)
spectro(wav1, flim = c(0, 10), wl = 100)
spectro(wav1, flim = c(1, 10), wl = 100)
spectro(wav1, flim = c(1, 10), wl = 200)
spectro(wav1, flim = c(1, 10), wl = 100)
spectro(wav1, flim = c(1, 10), wl = 512)
tlimsize <- 0.7
wav <-pastew(wave2 = wav1, wave1 = wav1, f = wav@samp.rate,
output = "Wave")
spectro(wav)
# frames per second
fps <- 100
#margin
marg <- tlimsize / 2
duration(wav1)
wav1 <- readWave("~/Dropbox/PAE3 new 062715 DT4.wav", units = "seconds", from = 0, to = 8)
spectro(wav1, flim = c(1, 10), wl = 100)
wav <-pastew(wave2 = wav1, wave1 = wav1, f = wav@samp.rate,
output = "Wave")
spectro(wav)
fps <- 100
marg <- tlimsize / 2
setwd(tempdir())
unlink(list.files(pattern = "\\.tiff"))
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = c(2, 13), tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(3, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
wav1 <- readWave("~/Dropbox/PAE3 new 062715 DT4.wav", units = "seconds", from = 0, to = 8)
spectro(wav1, flim = c(1, 10), wl = 100)
tlimsize <- 0.7
wav <-pastew(wave2 = wav1, wave1 = wav1, f = wav@samp.rate,
output = "Wave")
spectro(wav)
# frames per second
fps <- 100
#margin
marg <- tlimsize / 2
flim <- c(1, 10)
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(3, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
tlimsize <- 2
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(3, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
tlim <- c(x, x + tlimsize)
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(3, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
tiff("fee%04d.tiff",res = 120, width = 2300, height = 600)
#loop to create image files
out <- pbapply::pblapply(seq(0, (length(wav@left)/wav@samp.rate) - tlimsize, by = 1/fps), function(x)
{  tlim <- c(x, x + tlimsize)
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(3, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
#add text
# par(family = "helvetica")
# text(x = tlim[1] + (tlimsize/2), y = 7, labels =  "Marcelo Araya-Salas", cex = 7, adj = 0.5, col = "black", font = 2)
# abline(v = tlim[1]+marg, lty = 2, col = "skyblue", lwd = 2)
# x <- x + 1/fps
# stop when the end is reached
# if(x >= (length(wav@left)/wav@samp.rate) - tlimsize) break
}
)
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
dev.off()
dev.off()
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = T, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
out <- pbapply::pblapply(seq(0, (length(wav@left)/wav@samp.rate) - tlimsize, by = 1/fps), function(x)
{  tlim <- c(x, x + tlimsize)
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
#add text
# par(family = "helvetica")
# text(x = tlim[1] + (tlimsize/2), y = 7, labels =  "Marcelo Araya-Salas", cex = 7, adj = 0.5, col = "black", font = 2)
# abline(v = tlim[1]+marg, lty = 2, col = "skyblue", lwd = 2)
# x <- x + 1/fps
# stop when the end is reached
# if(x >= (length(wav@left)/wav@samp.rate) - tlimsize) break
}
)
tiff("fee%04d.tiff",res = 120, width = 2300, height = 600)
out <- pbapply::pblapply(seq(0, (length(wav@left)/wav@samp.rate) - tlimsize, by = 1/fps), function(x)
{  tlim <- c(x, x + tlimsize)
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
#add text
# par(family = "helvetica")
# text(x = tlim[1] + (tlimsize/2), y = 7, labels =  "Marcelo Araya-Salas", cex = 7, adj = 0.5, col = "black", font = 2)
# abline(v = tlim[1]+marg, lty = 2, col = "skyblue", lwd = 2)
# x <- x + 1/fps
# stop when the end is reached
# if(x >= (length(wav@left)/wav@samp.rate) - tlimsize) break
}
)
system("ffmpeg -framerate 10 -i fee%04d.tiff -c:v libx264 -profile:v high -crf 2 -pix_fmt yuv420p y.mp4")
tlimsize <- 4
setwd(tempdir())
unlink(list.files(pattern = "\\.tiff"))
tiff("fee%04d.tiff",res = 120, width = 2300, height = 600)
out <- pbapply::pblapply(seq(0, (length(wav@left)/wav@samp.rate) - tlimsize, by = 1/fps), function(x)
{  tlim <- c(x, x + tlimsize)
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
#add text
# par(family = "helvetica")
# text(x = tlim[1] + (tlimsize/2), y = 7, labels =  "Marcelo Araya-Salas", cex = 7, adj = 0.5, col = "black", font = 2)
# abline(v = tlim[1]+marg, lty = 2, col = "skyblue", lwd = 2)
# x <- x + 1/fps
# stop when the end is reached
# if(x >= (length(wav@left)/wav@samp.rate) - tlimsize) break
}
)
unlink(list.files(pattern = "\\.tiff"))
png("fee%04d.tiff",res = 120, width = 2300, height = 600)
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
dev.off()
dev.off()
dev.off()
dev.off()
dev.off()
png("feex.tiff",res = 120, width = 2300, height = 600)
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
dev.off()
png("feex.png",res = 120, width = 2300, height = 600)
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
dev.off()
unlink(list.files(pattern = "\\.tiff"))
png("fee%04d.png",res = 120, width = 2300, height = 600)
#loop to create image files
out <- pbapply::pblapply(seq(0, (length(wav@left)/wav@samp.rate) - tlimsize, by = 1/fps), function(x)
{  tlim <- c(x, x + tlimsize)
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
#add text
# par(family = "helvetica")
# text(x = tlim[1] + (tlimsize/2), y = 7, labels =  "Marcelo Araya-Salas", cex = 7, adj = 0.5, col = "black", font = 2)
# abline(v = tlim[1]+marg, lty = 2, col = "skyblue", lwd = 2)
# x <- x + 1/fps
# stop when the end is reached
# if(x >= (length(wav@left)/wav@samp.rate) - tlimsize) break
}
)
dev.off()
dev.off()
dev.off()
png("fee%04d.png",res = 120, width = 2300, height = 600)
#loop to create image files
out <- pbapply::pblapply(seq(0, (length(wav@left)/wav@samp.rate) - tlimsize, by = 1/fps), function(x)
{  tlim <- c(x, x + tlimsize)
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
#add text
# par(family = "helvetica")
# text(x = tlim[1] + (tlimsize/2), y = 7, labels =  "Marcelo Araya-Salas", cex = 7, adj = 0.5, col = "black", font = 2)
# abline(v = tlim[1]+marg, lty = 2, col = "skyblue", lwd = 2)
# x <- x + 1/fps
# stop when the end is reached
# if(x >= (length(wav@left)/wav@samp.rate) - tlimsize) break
}
)
dev.off()
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white", oma = c(0, 0, 0, 0))
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white", oma = rep(-1, 4))
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white", oma = rep(1, 4))
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white", oma = rep(0, 4))
par(mar = rep(0, 4))
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white", oma = rep(0, 4))
par(mar = rep(-1, 4))
tiff("fee%04d.tiff",res = 120, width = 2300, height = 600)
unlink(list.files(pattern = "\\.tiff"))
out <- pbapply::pblapply(seq(0, (length(wav@left)/wav@samp.rate) - tlimsize, by = 1/fps), function(x)
{  tlim <- c(x, x + tlimsize)
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
#add text
# par(family = "helvetica")
# text(x = tlim[1] + (tlimsize/2), y = 7, labels =  "Marcelo Araya-Salas", cex = 7, adj = 0.5, col = "black", font = 2)
# abline(v = tlim[1]+marg, lty = 2, col = "skyblue", lwd = 2)
# x <- x + 1/fps
# stop when the end is reached
# if(x >= (length(wav@left)/wav@samp.rate) - tlimsize) break
}
)
tiff("fee%04d.tiff",res = 20, width = 2300, height = 600)
out <- pbapply::pblapply(seq(0, (length(wav@left)/wav@samp.rate) - tlimsize, by = 1/fps), function(x)
{  tlim <- c(x, x + tlimsize)
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
#add text
# par(family = "helvetica")
# text(x = tlim[1] + (tlimsize/2), y = 7, labels =  "Marcelo Araya-Salas", cex = 7, adj = 0.5, col = "black", font = 2)
# abline(v = tlim[1]+marg, lty = 2, col = "skyblue", lwd = 2)
# x <- x + 1/fps
# stop when the end is reached
# if(x >= (length(wav@left)/wav@samp.rate) - tlimsize) break
}
)
dev.off()
system("ffmpeg  -t 12 -ss 00:00:00 -i y.mp4 y.gif")
24*1.5
library(warbleR)
flim <- c(1, 10)
wav1 <- readWave("~/Dropbox/PAE3 new 062715 DT4.wav", units = "seconds", from = 0, to = 8)
spectro(wav1, flim = flim, wl = 100)
wav1 <- readWave("~/Dropbox/PAE3 new 062715 DT4.wav", units = "seconds", from = 0.1, to = 3.8)
spectro(wav1, flim = flim, wl = 100)
wav1 <- readWave("~/Dropbox/PAE3 new 062715 DT4.wav", units = "seconds", from = 0.4, to = 3.9)
spectro(wav1, flim = flim, wl = 100)
wav1 <- readWave("~/Dropbox/PAE3 new 062715 DT4.wav", units = "seconds", from = 0.4, to = 3.85)
spectro(wav1, flim = flim, wl = 100)
tlimsize <- 4
wav <-pastew(wave2 = wav1, wave1 = wav1, f = wav@samp.rate,
output = "Wave")
spectro(wav)
fps <- 40
marg <- tlimsize / 2
setwd('~/Desktop/a')
unlink(list.files(pattern = "\\.tiff"))
tiff("fee%04d.tiff",res = 120, width = 2000, height = 500)
# png("fee%04d.png",res = 120, width = 2300, height = 600)
#loop to create image files
out <- pbapply::pblapply(seq(0, (length(wav@left)/wav@samp.rate) - tlimsize, by = 1/fps), function(x)
{  tlim <- c(x, x + tlimsize)
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
#add text
# par(family = "helvetica")
# text(x = tlim[1] + (tlimsize/2), y = 7, labels =  "Marcelo Araya-Salas", cex = 7, adj = 0.5, col = "black", font = 2)
# abline(v = tlim[1]+marg, lty = 2, col = "skyblue", lwd = 2)
# x <- x + 1/fps
# stop when the end is reached
# if(x >= (length(wav@left)/wav@samp.rate) - tlimsize) break
}
)
dev.off()
system("ffmpeg -framerate 20 -i fee%04d.tiff -c:v libx264 -profile:v high -crf 2 -pix_fmt yuv420p z.mp4")
wav <-pastew(wave2 = wav, wave1 = wav1, f = wav@samp.rate,
output = "Wave")
spectro(wav)
fps <- 40
#margin
# marg <- tlimsize / 2
#add silence
# wav <-pastew(wave2 = silence(duration = marg, samp.rate = wav1@samp.rate,
#                              xunit = "time"), wave1 = wav1, f = wav@samp.rate,
#              output = "Wave")
#
# wav <-pastew(wave1 = silence(duration = marg, samp.rate = wav@samp.rate,
#                              xunit = "time"), wave2 = wav, f = wav@samp.rate,
#              output = "Wave")
setwd('~/Desktop/a')
unlink(list.files(pattern = "\\.tiff"))
#start graphic device to create image files
tiff("fee%04d.tiff",res = 120, width = 2000, height = 500)
# png("fee%04d.png",res = 120, width = 2300, height = 600)
#loop to create image files
out <- pbapply::pblapply(seq(0, (length(wav@left)/wav@samp.rate) - tlimsize, by = 1/fps), function(x)
{  tlim <- c(x, x + tlimsize)
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
#add text
# par(family = "helvetica")
# text(x = tlim[1] + (tlimsize/2), y = 7, labels =  "Marcelo Araya-Salas", cex = 7, adj = 0.5, col = "black", font = 2)
# abline(v = tlim[1]+marg, lty = 2, col = "skyblue", lwd = 2)
# x <- x + 1/fps
# stop when the end is reached
# if(x >= (length(wav@left)/wav@samp.rate) - tlimsize) break
}
)
dev.off()
system("ffmpeg -framerate 20 -i fee%04d.tiff -c:v libx264 -profile:v high -crf 2 -pix_fmt yuv420p zz.mp4")
system("ffmpeg  -t 6 -ss 00:00:00 -i zz.mp4 zz.gif")
duration(wav)
duration(wav1)
duration(wav1)*2
system("ffmpeg  -t 6.9 -ss 00:00:00 -i zz.mp4 zz.gif")
system("ffmpeg  -t 6.9 -ss 00:00:00 -i zz.mp4 -crf 20 zz.gif")
unlink(list.files(pattern = "\\.tiff"))
tiff("fee%04d.tiff",res = 120, width = 1800, height = 450)
# png("fee%04d.png",res = 120, width = 2300, height = 600)
#loop to create image files
out <- pbapply::pblapply(seq(0, (length(wav@left)/wav@samp.rate) - tlimsize, by = 1/fps), function(x)
{  tlim <- c(x, x + tlimsize)
spectro(wave = wav, f = wav@samp.rate, wl = 150, ovlp = 90,
flim = flim, tlim = tlim, scale = F, grid = F,
palette = temp.colors,  norm = F, dBref = 2*10e-5, heights = c(1, 1),
osc = T, colgrid="white", colwave="chocolate2", axisX = F, axisY = F,
colaxis="white", collab="white", colbg="white")
#add text
# par(family = "helvetica")
# text(x = tlim[1] + (tlimsize/2), y = 7, labels =  "Marcelo Araya-Salas", cex = 7, adj = 0.5, col = "black", font = 2)
# abline(v = tlim[1]+marg, lty = 2, col = "skyblue", lwd = 2)
# x <- x + 1/fps
# stop when the end is reached
# if(x >= (length(wav@left)/wav@samp.rate) - tlimsize) break
}
)
dev.off()
system("ffmpeg -framerate 20 -i fee%04d.tiff -c:v libx264 -profile:v high -crf 2 -pix_fmt yuv420p zz.mp4")
# #
duration(wav1)*2
system("ffmpeg  -t 6.9 -ss 00:00:00 -i zz.mp4 -crf 20 zz.gif")
